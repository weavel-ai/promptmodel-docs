# Self-Hosting

You have the option to self-host your own instance of Promptmodel. We provide both Docker Compose and Railway templates for easy setup.

## Railway Template

You can easily deploy your own instance of `Promptmodel` with our **Railway Template**.

<div style={{ width: 'fit-content', marginTop: '1.5rem' }}>
  [![Deploy on
  Railway](https://railway.app/button.svg)](https://railway.app/template/uzaE0r)
</div>

You should update 2 environment variables after deploying.

- frontend
  - `BACKEND_PUBLIC_URL` is the url of the backend server. It should be updated to backend's public url created by Railway.
  - `FRONTEND_PUBLIC_URL` is the url of the frontend server. It should be updated to frontend's public url created by Railway.
- backend
  - `FRONTEND_PUBLIC_URL` is the url of the frontend server. It should be updated to frontend's public url created by Railway.

## Docker

> Requirements: docker and docker compose, both included in Docker Desktop

### Start

Before deploying, you need to configure the following environment variables in the `.env` file:

```bash
# .env
NEXTAUTH_SECRET=yoursecret # Required

POSTGRES_USER=yourusername  # Optional, postgres by default
POSTGRES_PASSWORD=yourpassword  # Optional, postgres by default
POSTGRES_DB=dbname # Optional, postgres by default
POSTGRES_PORT=5432	# Optional, 5432 by default
BACKEND_PUBLIC_URL=http://localhost:8000
FRONTEND_PUBLIC_URL=http://localhost:3000
```

- Postgres variables

  - `POSTGRES_DB`, `POSTGRES_USER` and `POSTGRES_PASSWORD` are the credentials for the postgres database.
  - `POSTGRES_PORT` is the port on which the postgres database is running. We recommend using the default port `5432`.

- Authentication secret key

  - `NEXTAUTH_SECRET` is a secret for the authentication. We use [next-auth](https://next-auth.js.org/) for authentication.

- Endpoint urls
  - `BACKEND_PUBLIC_URL` is the url of the backend server. It should be updated to backend's public url.
  - `FRONTEND_PUBLIC_URL` is the url of the frontend server. It should be updated to frontend's public url.

{/* Optional environment variables: */}

{/* ```bash */}

{/* # .env */}

{/* NEXT_PUBLIC_AUTH_GOOGLE_CLIENT_ID=your_google_id */}
{/* NEXT_PUBLIC_AUTH_GOOGLE_CLIENT_SECRET=your_google_secret */}
{/* NEXT_PUBLIC_AUTH_GITHUB_CLIENT_ID=your_github_id */}
{/* NEXT_PUBLIC_AUTH_GITHUB_CLIENT_SECRET=your_github_secret */}
{/*  */}
{/* ```` */}
{/*  */}
{/* - Google Authentication */}
{/* - `NEXT_PUBLIC_AUTH_GOOGLE_CLIENT_ID` and `NEXT_PUBLIC_AUTH_GOOGLE_CLIENT_SECRET` are the credentials for the google authentication. */}
{/* - Github Authentication */}
{/* - `NEXT_PUBLIC_AUTH_GITHUB_CLIENT_ID` and `NEXT_PUBLIC_AUTH_GITHUB_CLIENT_SECRET` are the credentials for the github authentication. */}

After you have configured the environment variables, you can start the container with the following command:

```bash
docker compose up
```

-> Visit http://localhost:3000 (or frontend public URL)

> This will build the docker images of a Next.js frontend, FastAPI backend server, postgres database, redis and postgres-redis listener for realtime.

### Upgrade

```bash
cd promptmodel

git pull
docker compose down
docker compose build --no-cache
docker compose up
```

## Support

If you encounter any issues, you can ask for help on [Discord](https://www.promptmodel.run/discord).
